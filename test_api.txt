[1mğŸ¯ Iniciando testes da API Flask...[0m
[33mâš™ï¸ Modo debug: ATIVADO[0m
[33mğŸ”§ Para desativar debug, mude debugMode para false[0m

[1mğŸš€ TESTE COMPLETO DA API - VERSÃƒO 4.0[0m
[34mğŸ“… 19/06/2025, 21:23:11[0m
[34mğŸ”— Base URL: http://localhost:5000/api[0m

[1mğŸ” VERIFICANDO SERVIDOR[0m
[32mâœ… Servidor Flask rodando[0m
[32mâœ… VersÃ£o: 2.0[0m
[32mâœ… Database: MySQL[0m

[1mğŸ” SEÃ‡ÃƒO 1: AUTENTICAÃ‡ÃƒO[0m
[34mğŸ“¤ Dados enviados: {
  "email": "maria.rh@techsolutions.com",
  "senha": "123456"
}[0m
[36mğŸŒ POST http://localhost:5000/api/auth/login[0m

[36m=== Login RH ===[0m
âœ… Status: [32m200[0m
[33mâœ… Token recebido: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...[0m
[33mğŸ‘¤ UsuÃ¡rio: Maria Silva (maria.rh@techsolutions.com)[0m
[32mğŸ”‘ Token rh salvo com sucesso[0m
[34mğŸ“¤ Dados enviados: {
  "email": "joao.gestor@techsolutions.com",
  "senha": "123456"
}[0m
[36mğŸŒ POST http://localhost:5000/api/auth/login[0m

[36m=== Login Gestor ===[0m
âœ… Status: [32m200[0m
[33mâœ… Token recebido: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...[0m
[33mğŸ‘¤ UsuÃ¡rio: JoÃ£o Santos (joao.gestor@techsolutions.com)[0m
[32mğŸ”‘ Token gestor salvo com sucesso[0m
[34mğŸ“¤ Dados enviados: {
  "email": "ana.dev@techsolutions.com",
  "senha": "123456"
}[0m
[36mğŸŒ POST http://localhost:5000/api/auth/login[0m

[36m=== Login UsuÃ¡rio Comum ===[0m
âœ… Status: [32m200[0m
[33mâœ… Token recebido: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...[0m
[33mğŸ‘¤ UsuÃ¡rio: Ana Costa (ana.dev@techsolutions.com)[0m
[32mğŸ”‘ Token comum salvo com sucesso[0m
[34mğŸ“¤ Dados enviados: {
  "email": "inexistente@test.com",
  "senha": "senha_errada"
}[0m
[36mğŸŒ POST http://localhost:5000/api/auth/login[0m

[36m=== Login InvÃ¡lido (deve falhar) ===[0m
âœ… Status: [32m401[0m
[33mğŸ“„ Response: {
  "autenticado": false,
  "erro": "Credenciais invÃ¡lidas"
}[0m
[34mğŸ“¤ Dados enviados: {
  "email": "maria.rh@techsolutions.com",
  "senha": "senha_errada"
}[0m
[36mğŸŒ POST http://localhost:5000/api/auth/login[0m

[36m=== Login com Senha Incorreta (deve falhar) ===[0m
âœ… Status: [32m401[0m
[33mğŸ“„ Response: {
  "autenticado": false,
  "erro": "Credenciais invÃ¡lidas"
}[0m

[33mğŸ§ª Testando endpoint /me com token RH...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/auth/me[0m

[36m=== Endpoint /me ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "usuario": {
    "UF": "SP",
    "ativo": true,
    "cpf": 12345678901,
    "criado_em": "2025-06-04T23:12:14",
    "email": "maria.rh@techsolutions.com",
    "flag_gestor": "N",
    "grupo_id": 2,
    "grupo_nome": "Recursos Humanos",
    "inicio_na_empresa": "2020-01-15",
    "nome": "Maria Si...[0m

[1mğŸŒ SEÃ‡ÃƒO 2: ENDPOINTS PÃšBLICOS[0m
[36mğŸŒ GET http://localhost:5000/api/ufs[0m

[36m=== Listar UFs (pÃºblico) ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 27 itens[0m
[33mğŸ“„ Primeiro item: {
  "cod_uf": 12,
  "uf": "AC"
}...[0m
[36mğŸŒ GET http://localhost:5000/api/tipos-ausencia[0m

[36m=== Listar Tipos de AusÃªncia (pÃºblico) ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 10 itens[0m
[33mğŸ“„ Primeiro item: {
  "descricao": "FÃ©rias",
  "id": 1,
  "usa_turno": false
}...[0m
[36mğŸŒ GET http://localhost:5000/api/turnos[0m

[36m=== Listar Turnos (pÃºblico) ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 5 itens[0m
[33mğŸ“„ Primeiro item: {
  "descricao": "ManhÃ£",
  "id": 1
}...[0m
[36mğŸŒ GET http://localhost:5000/api/feriados[0m

[36m=== Listar Feriados (pÃºblico) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "listar_feriados_nacionais() takes 0 positional arguments but 1 was given"
}[0m

[1mğŸ”’ SEÃ‡ÃƒO 3: ENDPOINTS PROTEGIDOS[0m

[36mğŸ‘©â€ğŸ’¼ Testando com usuÃ¡rio RH[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios[0m

[36m=== RH - Listar UsuÃ¡rios ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 18 itens[0m
[33mğŸ“„ Primeiro item: {
  "UF": "SP",
  "ativo": true,
  "cpf": 123,
  "criado_em": "2025-06-05T19:39:55",
  "email": "cpf...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/grupos[0m

[36m=== RH - Listar Grupos ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 26 itens[0m
[33mğŸ“„ Primeiro item: {
  "ativo": true,
  "cnpj_empresa": 12345678000190,
  "criado_em": "2025-06-04",
  "descricao": "Eq...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/empresas[0m

[36m=== RH - Listar Empresas ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 1 itens[0m
[33mğŸ“„ Primeiro item: {
  "ativa": true,
  "cnpj": 12345678000190,
  "criado_em": "2025-06-04",
  "email": "contato@techso...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario[0m

[36m=== RH - Listar CalendÃ¡rio ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 58 itens[0m
[33mğŸ“„ Primeiro item: {
  "backgroundColor": "#ffc107",
  "borderColor": "#ffc107",
  "end": "2025-07-16",
  "extendedProp...[0m

[36mğŸ‘¨â€ğŸ’¼ Testando com usuÃ¡rio Gestor[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios[0m

[36m=== Gestor - Listar UsuÃ¡rios do Grupo ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 12 itens[0m
[33mğŸ“„ Primeiro item: {
  "UF": "SP",
  "ativo": true,
  "cpf": 16440627430,
  "criado_em": "2025-06-05T19:39:43",
  "emai...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/empresas[0m

[36m=== Gestor - Tentar Acessar Empresas (deve falhar) ===[0m
âœ… Status: [32m403[0m
[33mğŸ“„ Response: {
  "erro": "Apenas RH pode acessar dados de empresas"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario/grupo/3[0m

[36m=== Gestor - Listar CalendÃ¡rio do Grupo ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "eventos": [
    {
      "backgroundColor": "#ffc107",
      "borderColor": "#ffc107",
      "end": "2025-06-20",
      "extendedProps": {
        "cpf_usuario": 34567890123,
        "criado_em": "2025-06-05T00:30:49",
        "status": "pendente",
        "tipo_ausencia": "Desconhecido"
      }...[0m

[36mğŸ‘¤ Testando com usuÃ¡rio Comum[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/eventos[0m

[36m=== UsuÃ¡rio - Listar Eventos PrÃ³prios ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 0 itens[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "99988877766",
  "nome": "Teste Sem PermissÃ£o",
  "email": "teste.sem.permissao.1750379131379@example.com",
  "senha": "123456",
  "grupo_id": 3,
  "inicio_na_empresa": "2023-01-01",
  "uf": "SP",
  "tipo_usuario": "comum",
  "flag_gestor": "N"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== UsuÃ¡rio - Tentar Criar UsuÃ¡rio (deve falhar) ===[0m
âœ… Status: [32m403[0m
[33mğŸ“„ Response: {
  "erro": "Sem permissÃ£o para criar usuÃ¡rios"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario/grupo/1[0m

[36m=== UsuÃ¡rio - Tentar Acessar CalendÃ¡rio de Outro Grupo (deve falhar) ===[0m
âœ… Status: [32m403[0m
[33mğŸ“„ Response: {
  "erro": "Sem permissÃ£o para acessar dados deste grupo"
}[0m

[1mğŸ“ SEÃ‡ÃƒO 4: OPERAÃ‡Ã•ES CRUD BÃSICAS[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/grupos/2[0m
[34mğŸ¢ CNPJ da empresa do RH: 12345678000190[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "nome": "Grupo Teste 1750379137440",
  "cnpj_empresa": 12345678000190,
  "telefone": "(11) 1234-5678",
  "descricao": "Grupo criado durante teste automatizado"
}[0m
[36mğŸŒ POST http://localhost:5000/api/grupos[0m

[36m=== Criar Novo Grupo ===[0m
âœ… Status: [32m201[0m
[33mğŸ“„ Response: {
  "ativo": true,
  "cnpj_empresa": 12345678000190,
  "criado_em": "2025-06-19",
  "descricao": "Grupo criado durante teste automatizado",
  "empresa_nome": "Tech Solutions LTDA",
  "id": 48,
  "nome": "Grupo Teste 1750379137440",
  "telefone": "(11) 1234-5678",
  "total_usuarios": 0
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "descricao": "Grupo atualizado durante teste"
}[0m
[36mğŸŒ PUT http://localhost:5000/api/grupos/48[0m

[36m=== Atualizar Grupo Criado ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "status": "Grupo atualizado"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-06-15",
  "data_fim": "2025-06-19",
  "id_tipo_ausencia": 2,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== UsuÃ¡rio - Criar Novo Evento (NÃ£o-FÃ©rias) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m

[1mğŸ›¡ï¸ SEÃ‡ÃƒO 5: VALIDAÃ‡Ã•ES DE SEGURANÃ‡A[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios[0m

[36m=== Acesso sem token (deve falhar) ===[0m
âœ… Status: [32m401[0m
[33mğŸ“„ Response: {
  "erro": "Token de acesso necessÃ¡rio"
}[0m
[33mğŸ”‘ Token usado: token-completamente-...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios[0m

[36m=== Token invÃ¡lido (deve falhar) ===[0m
âœ… Status: [32m401[0m
[33mğŸ“„ Response: {
  "erro": "Token invÃ¡lido"
}[0m
[33mğŸ”‘ Token usado: Bearer token-malform...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios[0m

[36m=== Token malformado (deve falhar) ===[0m
âœ… Status: [32m401[0m
[33mğŸ“„ Response: {
  "erro": "Token invÃ¡lido"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/23456789012[0m

[36m=== Acessar Recurso de Outro UsuÃ¡rio (deve falhar) ===[0m
âœ… Status: [32m403[0m
[33mğŸ“„ Response: {
  "erro": "Sem permissÃ£o para acessar este usuÃ¡rio"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "nome": "Grupo Teste InvÃ¡lido CNPJ",
  "cnpj_empresa": "00000000000000",
  "telefone": "(11) 1234-5678"
}[0m
[36mğŸŒ POST http://localhost:5000/api/grupos[0m

[36m=== Criar Grupo com CNPJ InvÃ¡lido (verificar se validaÃ§Ã£o estÃ¡ ativa) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "CNPJ invÃ¡lido"
}[0m

[1mğŸ—“ï¸ SEÃ‡ÃƒO 7: FLUXO DE APROVAÃ‡ÃƒO DE EVENTOS[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-07-10",
  "data_fim": "2025-07-15",
  "id_tipo_ausencia": 2,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== Criar Evento (NÃ£o-FÃ©rias) para AprovaÃ§Ã£o ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m

[1mğŸ‘¥ SEÃ‡ÃƒO 8: CRIAÃ‡ÃƒO DE USUÃRIOS[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "50379151453",
  "nome": "Novo UsuÃ¡rio Comum Teste",
  "email": "novo.comum.teste.1750379151453@techsolutions.com",
  "senha": "123456",
  "grupo_id": 3,
  "inicio_na_empresa": "2023-01-01",
  "uf": "SP",
  "tipo_usuario": "comum",
  "flag_gestor": "N"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== Criar UsuÃ¡rio Comum como RH ===[0m
âœ… Status: [32m201[0m
[33mğŸ“„ Response: {
  "UF": "SP",
  "ativo": true,
  "cpf": 50379151453,
  "criado_em": "2025-06-19T21:25:55",
  "email": "novo.comum.teste.1750379151453@techsolutions.com",
  "flag_gestor": "N",
  "grupo_id": 3,
  "grupo_nome": "Desenvolvimento",
  "inicio_na_empresa": "2023-01-01",
  "nome": "Novo UsuÃ¡rio Comum Tes...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "50379156481",
  "nome": "Novo UsuÃ¡rio Gestor Teste",
  "email": "novo.gestor.teste.1750379156480@techsolutions.com",
  "senha": "123456",
  "grupo_id": 3,
  "inicio_na_empresa": "2023-01-01",
  "uf": "SP",
  "tipo_usuario": "comum",
  "flag_gestor": "S"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== Criar UsuÃ¡rio Gestor como RH ===[0m
âœ… Status: [32m201[0m
[33mğŸ“„ Response: {
  "UF": "SP",
  "ativo": true,
  "cpf": 50379156481,
  "criado_em": "2025-06-19T21:26:00",
  "email": "novo.gestor.teste.1750379156480@techsolutions.com",
  "flag_gestor": "S",
  "grupo_id": 3,
  "grupo_nome": "Desenvolvimento",
  "inicio_na_empresa": "2023-01-01",
  "nome": "Novo UsuÃ¡rio Gestor T...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "50379161475",
  "nome": "UsuÃ¡rio Grupo InvÃ¡lido Teste",
  "email": "grupo.invalido.teste.1750379161473@techsolutions.com",
  "senha": "123456",
  "grupo_id": 1,
  "inicio_na_empresa": "2023-01-01",
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== Criar UsuÃ¡rio em Grupo NÃ£o Autorizado (Gestor) (deve falhar) ===[0m
âœ… Status: [32m403[0m
[33mğŸ“„ Response: {
  "erro": "Sem permissÃ£o para criar usuÃ¡rios neste grupo"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "123",
  "nome": "UsuÃ¡rio CPF InvÃ¡lido Teste",
  "email": "cpf.invalido.teste.1750379163243@techsolutions.com",
  "senha": "123456",
  "grupo_id": 2,
  "inicio_na_empresa": "2023-01-01",
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== Criar UsuÃ¡rio com CPF InvÃ¡lido (verificar se validaÃ§Ã£o estÃ¡ ativa) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "CPF invÃ¡lido"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "50379164425",
  "nome": "UsuÃ¡rio Email Duplicado Teste",
  "email": "novo.comum.teste.1750379151453@techsolutions.com",
  "senha": "123456",
  "grupo_id": 2,
  "inicio_na_empresa": "2023-01-01",
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== Criar UsuÃ¡rio com Email Duplicado (deve falhar) ===[0m
âŒ Status: [31m400[0m
[33mğŸ“„ Response: {
  "erro": "Valor invÃ¡lido: Email jÃ¡ cadastrado"
}[0m

[1mğŸ¢ SEÃ‡ÃƒO 9: GERENCIAMENTO DE GRUPOS[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/grupos/2[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "nome": "",
  "cnpj_empresa": 12345678000190,
  "telefone": "(11) 1234-5678"
}[0m
[36mğŸŒ POST http://localhost:5000/api/grupos[0m

[36m=== Criar Grupo com Dados InvÃ¡lidos (deve falhar) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "Campo obrigatÃ³rio ausente: nome"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "nome": "Grupo Teste Completo 1750379172319",
  "cnpj_empresa": 12345678000190,
  "telefone": "(11) 1234-5678",
  "descricao": "Grupo para teste completo"
}[0m
[36mğŸŒ POST http://localhost:5000/api/grupos[0m

[36m=== Criar Novo Grupo VÃ¡lido ===[0m
âœ… Status: [32m201[0m
[33mğŸ“„ Response: {
  "ativo": true,
  "cnpj_empresa": 12345678000190,
  "criado_em": "2025-06-19",
  "descricao": "Grupo para teste completo",
  "empresa_nome": "Tech Solutions LTDA",
  "id": 49,
  "nome": "Grupo Teste Completo 1750379172319",
  "telefone": "(11) 1234-5678",
  "total_usuarios": 0
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "nome": "Grupo Atualizado Teste",
  "descricao": "DescriÃ§Ã£o atualizada durante teste"
}[0m
[36mğŸŒ PUT http://localhost:5000/api/grupos/49[0m

[36m=== Atualizar Grupo ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "status": "Grupo atualizado"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "descricao": "Tentativa de atualizaÃ§Ã£o por gestor"
}[0m
[36mğŸŒ PUT http://localhost:5000/api/grupos/49[0m

[36m=== Atualizar Grupo como Gestor (deve falhar) ===[0m
âœ… Status: [32m403[0m
[33mğŸ“„ Response: {
  "erro": "Sem permissÃ£o para acessar dados deste grupo"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ DELETE http://localhost:5000/api/grupos/49[0m

[36m=== Desativar Grupo ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "status": "Grupo desativado"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/grupos/49[0m

[36m=== Verificar Grupo Desativado (GET) ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "ativo": false,
  "cnpj_empresa": 12345678000190,
  "criado_em": "2025-06-19",
  "descricao": "DescriÃ§Ã£o atualizada durante teste",
  "empresa_nome": "Tech Solutions LTDA",
  "id": 49,
  "nome": "Grupo Atualizado Teste",
  "telefone": "(11) 1234-5678",
  "total_usuarios": 0
}[0m
[32mâœ… Grupo corretamente marcado como inativo.[0m

[1mğŸ” SEÃ‡ÃƒO 10: VALIDAÃ‡ÃƒO DE DADOS[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-07-15",
  "data_fim": "2025-07-10",
  "id_tipo_ausencia": 2,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== Criar Evento com Data InvÃ¡lida (deve falhar) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "Data de inÃ­cio nÃ£o pode ser posterior Ã  data de fim"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-07-10",
  "data_fim": "2025-07-15",
  "id_tipo_ausencia": 9999,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== Criar Evento com Tipo Inexistente (deve falhar) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "Tipo de ausÃªncia invÃ¡lido"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "50379191342",
  "nome": "UsuÃ¡rio UF InvÃ¡lida Teste",
  "email": "uf.invalida.teste.1750379191338@techsolutions.com",
  "senha": "123456",
  "grupo_id": 2,
  "inicio_na_empresa": "2023-01-01",
  "uf": "XX"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== Criar UsuÃ¡rio com UF InvÃ¡lida (deve falhar) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "UF invÃ¡lida"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/grupos/2[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "nome": "Grupo Sem Telefone Teste 1750379196234",
  "cnpj_empresa": 12345678000190
}[0m
[36mğŸŒ POST http://localhost:5000/api/grupos[0m

[36m=== Criar Grupo Sem Telefone (deve falhar) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "Campo obrigatÃ³rio ausente: telefone"
}[0m

[1mğŸ“… SEÃ‡ÃƒO 11: CALENDÃRIO E VISUALIZAÃ‡Ã•ES[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario[0m

[36m=== CalendÃ¡rio Geral (RH) ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 58 itens[0m
[33mğŸ“„ Primeiro item: {
  "backgroundColor": "#ffc107",
  "borderColor": "#ffc107",
  "end": "2025-07-16",
  "extendedProp...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario?inicio=2025-06-20&fim=2025-09-20[0m

[36m=== CalendÃ¡rio com Filtro de Data ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 11 itens[0m
[33mğŸ“„ Primeiro item: {
  "backgroundColor": "#ffc107",
  "borderColor": "#ffc107",
  "end": "2025-07-16",
  "extendedProp...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario/grupo/3[0m

[36m=== CalendÃ¡rio de Grupo EspecÃ­fico ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "eventos": [
    {
      "backgroundColor": "#ffc107",
      "borderColor": "#ffc107",
      "end": "2025-06-20",
      "extendedProps": {
        "cpf_usuario": 34567890123,
        "criado_em": "2025-06-05T00:30:49",
        "status": "pendente",
        "tipo_ausencia": "Desconhecido"
      }...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario?tipo_ausencia=1[0m

[36m=== CalendÃ¡rio com Filtro de Tipo de AusÃªncia ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 58 itens[0m
[33mğŸ“„ Primeiro item: {
  "backgroundColor": "#ffc107",
  "borderColor": "#ffc107",
  "end": "2025-07-16",
  "extendedProp...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/calendario[0m

[36m=== CalendÃ¡rio para UsuÃ¡rio Comum ===[0m
âœ… Status: [32m200[0m
[33mğŸ“‹ Array com 46 itens[0m
[33mğŸ“„ Primeiro item: {
  "backgroundColor": "#ffc107",
  "borderColor": "#ffc107",
  "end": "2025-06-20",
  "extendedProp...[0m

[1mğŸ–ï¸ SEÃ‡ÃƒO 12: TESTES DO SISTEMA DE FÃ‰RIAS[0m

[36mğŸ“… 12.1 ValidaÃ§Ãµes na CriaÃ§Ã£o de Eventos de FÃ©rias (UsuÃ¡rio Comum)[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-06-21",
  "data_fim": "2025-06-25",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - InÃ­cio no SÃ¡bado (deve falhar) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-06-23",
  "data_fim": "2025-06-22",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Fim no Domingo (deve falhar) ===[0m
âœ… Status: [32m400[0m
[33mğŸ“„ Response: {
  "erro": "Data de inÃ­cio nÃ£o pode ser posterior Ã  data de fim"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-12-25",
  "data_fim": "2025-12-27",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - InÃ­cio em Feriado (2025-12-25) (deve falhar) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2025-12-22",
  "data_fim": "2025-12-25",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Fim em Feriado (2025-12-25) (deve falhar) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2026-01-05",
  "data_fim": "2026-02-13",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Agendar mais de 30 dias de uma vez (deve falhar) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/34567890123/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== FÃ©rias - Saldo Inicial UsuÃ¡rio Comum ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2026-03-02",
  "data_fim": "2026-03-11",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Agendar 10 dias (vÃ¡lido) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/34567890123/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2026-04-06",
  "data_fim": "2026-04-30",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Agendar mais 25 dias (deve falhar se 10 aprovados e saldo < 25) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m

[36mğŸ§‘â€ğŸ’¼ 12.2 Endpoint de Saldo de FÃ©rias (/usuarios/{cpf}/vacation-allowance)[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/34567890123/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== Saldo FÃ©rias - RH para UsuÃ¡rio Comum ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/34567890123/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== Saldo FÃ©rias - Gestor para Membro do Grupo ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/12345678901/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== Saldo FÃ©rias - Gestor para Fora do Grupo (deve falhar) ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/34567890123/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== Saldo FÃ©rias - UsuÃ¡rio Comum para PrÃ³prio Saldo ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/12345678901/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== Saldo FÃ©rias - UsuÃ¡rio Comum para Outro (deve falhar) ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/00000000000/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== Saldo FÃ©rias - UsuÃ¡rio Inexistente (deve falhar) ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m

[36mğŸ‘¶ 12.3 ValidaÃ§Ã£o de Tempo MÃ­nimo de Empresa[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf": "50379357013",
  "nome": "Empregado Recente Teste FÃ©rias",
  "email": "novo.ferias.50379357013@test.com",
  "senha": "123456",
  "grupo_id": 3,
  "inicio_na_empresa": "2025-06-20",
  "uf": "SP",
  "tipo_usuario": "comum",
  "flag_gestor": "N"
}[0m
[36mğŸŒ POST http://localhost:5000/api/usuarios[0m

[36m=== FÃ©rias - Criar Novo Empregado (inÃ­cio hoje) ===[0m
âœ… Status: [32m201[0m
[33mğŸ“„ Response: {
  "UF": "SP",
  "ativo": true,
  "cpf": 50379357013,
  "criado_em": "2025-06-19T21:29:20",
  "email": "novo.ferias.50379357013@test.com",
  "flag_gestor": "N",
  "grupo_id": 3,
  "grupo_nome": "Desenvolvimento",
  "inicio_na_empresa": "2025-06-20",
  "nome": "Empregado Recente Teste FÃ©rias",
  "ti...[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 50379357013,
  "data_inicio": "2026-01-05",
  "data_fim": "2026-01-09",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Novo Empregado (<1 ano) tenta agendar (deve falhar) ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m

[36mğŸ‘ 12.4 ValidaÃ§Ã£o na AprovaÃ§Ã£o de Eventos de FÃ©rias (Gestor)[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/usuarios/34567890123/vacation-allowance[0m
[31mâŒ Erro na requisiÃ§Ã£o: Unexpected token < in JSON at position 0[0m

[36m=== FÃ©rias - Saldo do UsuÃ¡rio Comum antes dos testes de aprovaÃ§Ã£o em lote ===[0m
âŒ Status: [31mERROR[0m
[33mğŸ“„ Response: {
  "erro": "Unexpected token < in JSON at position 0"
}[0m
[34mâ„¹ï¸ Saldo atual do usuÃ¡rio comum para testes de aprovaÃ§Ã£o: 0 dias.[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2026-07-06",
  "data_fim": "2026-07-25",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Setup: Agendar 20 dias para aprovaÃ§Ã£o ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[34mğŸ“¤ Dados enviados: {
  "cpf_usuario": 34567890123,
  "data_inicio": "2026-08-03",
  "data_fim": "2026-08-17",
  "id_tipo_ausencia": 1,
  "uf": "SP"
}[0m
[36mğŸŒ POST http://localhost:5000/api/eventos[0m

[36m=== FÃ©rias - Setup: Agendar mais 15 dias para aprovaÃ§Ã£o ===[0m
âŒ Status: [31m500[0m
[33mğŸ“„ Response: {
  "erro": "criar_evento() missing 1 required positional argument: 'session'"
}[0m

[1mğŸ§¹ LIMPEZA DE DADOS DE TESTE[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ DELETE http://localhost:5000/api/usuarios/50379151453[0m

[36m=== Deletar UsuÃ¡rio CPF 50379151453 ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "status": "UsuÃ¡rio desativado"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ DELETE http://localhost:5000/api/usuarios/50379156481[0m

[36m=== Deletar UsuÃ¡rio CPF 50379156481 ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "status": "UsuÃ¡rio desativado"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ DELETE http://localhost:5000/api/usuarios/50379357013[0m

[36m=== Deletar UsuÃ¡rio CPF 50379357013 ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "status": "UsuÃ¡rio desativado"
}[0m
[32mâœ… 2 grupos foram marcados para limpeza (desativados em seus testes).[0m

[1mğŸšª SEÃ‡ÃƒO 6: LOGOUT[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ POST http://localhost:5000/api/auth/logout[0m

[36m=== Logout RH ===[0m
âœ… Status: [32m200[0m
[33mğŸ“„ Response: {
  "message": "Logout realizado com sucesso"
}[0m
[33mğŸ”‘ Token usado: eyJhbGciOiJIUzI1NiIs...[0m
[36mğŸŒ GET http://localhost:5000/api/auth/me[0m

[36m=== Usar token apÃ³s logout (deve falhar) ===[0m
âœ… Status: [32m401[0m
[33mğŸ“„ Response: {
  "erro": "Token invalidado"
}[0m

[1mğŸ“Š RELATÃ“RIO FINAL[0m
============================================================
[1mTotal de Testes:[0m 73
[32mTestes Passaram:[0m 52
[31mTestes Falharam:[0m 21
[1mTaxa de Sucesso:[0m [33m71.2%[0m

[1mğŸ”‘ TOKENS OBTIDOS:[0m
[32mâœ… RH: OK[0m
[32mâœ… GESTOR: OK[0m
[32mâœ… COMUM: OK[0m

[1mğŸ“ˆ ESTATÃSTICAS DE ENTIDADES CRIADAS/DELETADAS (TENTATIVAS):[0m
[34mğŸ—“ï¸ Eventos: 0[0m
[34mğŸ‘¤ UsuÃ¡rios: 0[0m
[34mğŸ¢ Grupos: 0[0m

[1mğŸ’¡ DIAGNÃ“STICO:[0m
[33mâš ï¸ API funcionando com alguns problemas.[0m

[1mğŸ”§ COMANDOS ÃšTEIS:[0m
[36m- Recriar dados: python scripts/seed_data_complete.py[0m
[36m- Verificar integridade: python scripts/validate_integrity.py[0m
[36m- Verificar ambiente: python scripts/check_environment.py[0m
